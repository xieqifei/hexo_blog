---
title: 订单卡片备注自动打印系统
top: false
cover: false
toc: true
mathjax: false
date: 2020-08-26 15:51:39
password:
summary: 在小程序、美团等设备接单后，顾客都会要求附送代写贺卡，这项工作所耗时间并不长，但当节假日来临，大量订单堆积，手写贺卡明显太耗时间。为了避免贺卡时间的消耗，我决定开发一套自动打印贺卡的系统。并在此记录完整的开发过程和思路。
tags: 电商系统
categories: 网站编程
---

# 一：系统设计

系统思维导图：

![](https://i.loli.net/2020/08/26/EVucX6TlpsqxiPz.png)

各个接单平台在收到订单后，将订单信息发送给公网服务器，公网服务器从订单信息中提取卡片内容，并将卡片内容发送给和打印机处在同一个局域网环境下的树莓派，树莓派发送打印请求。

由于打印机的打印请求必须在局域网环境下发出，内网穿透就是必须的步骤，所以这里的树莓派和公网服务器缺一不可，如果有固定的公网ip，则可取消公网服务器步骤，如果打印机支持http发送api请求创建打印进程，则可取消树莓派的作用。



# 二：准备工作

1. 申请美团和饿了么API接口。
2. 购买公网服务器，推荐阿里云和腾讯云，学生价购买轻量级应用服务器，一年100元左右。我由于已有小程序，因此和小程序公用了同一台服务器。小程序使用的是开源电商平台“ShopXO”。
3. 树莓派4B和一台打印机。打印机可选普通的喷墨打印机或者标签打印机。喷墨打印机打印的时候需要间歇的将贺卡放入打印机，而标签机则可连续的打印标签，可将打印后的标签贴在贺卡上。各有优缺点，专门购买一个连续打印贺卡的机器通常比较贵。此系统预算在1k元人民币。其中公网服务器100元/年，树莓派可根据自身资金选择，建议在100\~500，打印机在300\~800。不同的打印机在树莓派编程时，涉及的指令集是不同的。细节可能在后面选好后，在修改这里的内容。